<html>

<head>

    <style>
        h1 {
            text-align: center;
        }

        h2 {
            text-align: center;
        }

        p {
            text-align: left;
            font-size: 16;
        }

        body {
            display: flex;
            justify-content: center;
            align-items: left;
        }

        #warn {
            color: red;
            text-align: center;
        }

        .hidden {
            display: none;
        }

    </style>

</head>

<body>

    <div id="container">
        <h1>Survey</h1>
        <h2>Experience Questions</h2>
        <p id="warn"></p>
        <div class="questions">
            <p>How many years of programming experience do you have?</p>
            <input type="number" id="yearsOfExp" name="yearsOfExp" min="0" max="100" value="0">
        </div>

        <div class="questions">
            <p>How long have you been programming <b>in Rust</b>?</p>
            <select name="rustExp" id="rustExp">
                <option value=-1>Select</option>
                <option value=0>&lt; 1 month</option>
                <option value=0.5>A few months</option>
                <option value=1>1 year</option>
                <option value=2>2 years</option>
                <option value=3>3 years</option>
                <option value=3.5>4 years</option>
                <option value=4>5+ years</option>
            </select>
        </div>

        <div class="questions">
            <p>Roughly, how many lines of code have you written in Rust?</p>
            <select name="linesOfCode" id="linesOfCode">
                <option value=-1>Select</option>
                <option value=0>Less than 100</option>
                <option value=1>101 - 1000</option>
                <option value=2>1001 - 10000</option>
                <option value=3>10001 - 100000</option>
                <option value=4>More than 100000 lines</option>
            </select><br><br>
        </div>

        <div class="questions">

            <label>Have you programmed in a functional language before?</label><br>
            <input type="radio" name="fp-experience" id="fp-yes" value="yes" onclick="toggleFields(true)"> Yes<br>
            <input type="radio" name="fp-experience" id="fp-no" value="no" onclick="toggleFields(false)"> No<br><br>

            <div id="fp-languages" class="hidden">
                <label>If so, which ones?</label><br>
                <input type="checkbox" id="haskell" name="languages" value="haskell">
                <label for="haskell">Haskell</label><br>
                <input type="checkbox" id="scala" name="languages" value="scala">
                <label for="scala">Scala</label><br>
                <input type="checkbox" id="ocaml" name="languages" value="ocaml">
                <label for="ocaml">OCaml</label><br>
                <input type="checkbox" id="clojure" name="languages" value="clojure">
                <label for="clojure">Clojure</label><br>
                <input type="checkbox" id="erlang" name="languages" value="erlang">
                <label for="erlang">Erlang</label><br>
                <input type="checkbox" id="common-lisp" name="languages" value="common-lisp">
                <label for="common-lisp">Common Lisp</label><br>
                <input type="checkbox" id="other" name="languages" value="other">
                <label for="other">Other</label><br><br>
            </div>

            <div id="fp-yoe" class="hidden">
                <label for="years">If so, how many years of experience do you have in FP?</label><br>
                <input type="number" id="years" name="years" min="0" max="100" step="1"><br><br>
            </div>
        </div>

        <div class="questions">
            <p>What is your experience level in the following languages?</p>
            <h4>Java</h4>
            <input type="radio" name="java" value="none" id="java-none">
            <label for="java-none">None</label>
            <br />
            <input type="radio" name="java" value="novice" id="java-novice">
            <label for="java-novice">Novice</label>
            <br />
            <input type="radio" name="java" value="intermediate" id="java-inter">
            <label for="java-inter">Intermediate</label>
            <br />
            <input type="radio" name="java" value="expert" id="java-expert">
            <label for="java-expert">Expert</label>
            <br /><br />

            <h4>JavaScript</h4>
            <input type="radio" name="javascript" value="none" id="js-none">
            <label for="js-none">None</label>
            <br />
            <input type="radio" name="javascript" value="novice" id="js-novice">
            <label for="js-novice">Novice</label>
            <br />
            <input type="radio" name="javascript" value="intermediate" id="js-inter">
            <label for="js-inter">Intermediate</label>
            <br />
            <input type="radio" name="javascript" value="expert" id="js-expert">
            <label for="js-expert">Expert</label>
            <br /><br />

            <h4>C</h4>
            <input type="radio" name="clang" value="none" id="c-none">
            <label for="c-none">None</label>
            <br />
            <input type="radio" name="clang" value="novice" id="c-novice">
            <label for="c-novice">Novice</label>
            <br />
            <input type="radio" name="clang" value="intermediate" id="c-inter">
            <label for="c-inter">Intermediate</label>
            <br />
            <input type="radio" name="clang" value="expert" id="c-expert">
            <label for="c-expert">Expert</label>
            <br /><br />

            <h4>C++</h4>
            <input type="radio" name="cpp" value="none" id="c-none">
            <label for="cpp-none">None</label>
            <br />
            <input type="radio" name="cpp" value="novice" id="c-novice">
            <label for="cpp-novice">Novice</label>
            <br />
            <input type="radio" name="cpp" value="intermediate" id="c-inter">
            <label for="cpp-inter">Intermediate</label>
            <br />
            <input type="radio" name="cpp" value="expert" id="c-expert">
            <label for="cpp-expert">Expert</label>
            <br /><br />

            <h4>Python</h4>
            <input type="radio" name="python" value="none" id="python-none">
            <label for="python-none">None</label>
            <br />
            <input type="radio" name="python" value="novice" id="python-novice">
            <label for="python-novice">Novice</label>
            <br />
            <input type="radio" name="python" value="intermediate" id="python-inter">
            <label for="python-inter">Intermediate</label>
            <br />
            <input type="radio" name="python" value="expert" id="python-expert">
            <label for="python-expert">Expert</label>
            <br />
        </div>

        <div class="questions">
            <p>What resources have you used to learn Rust? &lpar;select all that apply&rpar;</p>

            <input type="checkbox" name="resources1" value="RustTextbook" id="resources1">
            <label for="resources1">The Rust Programming Language textbook</label>
            <br />
            <input type="checkbox" name="resources2" value="Youtube" id="resources2">
            <label for="resources2">Youtube</label>
            <br />
            <input type="checkbox" name="resources3" value="StackOverflow" id="resources3">
            <label for="resources3">Stack Overflow</label>
            <br />
            <input type="checkbox" name="resources4" value="Other" id="resources4">
            <label for="resources4">Other</label>
            <br />
        </div>

        <br /><br />
        <h2>Demographic Questions</h2>

        <div class="questions">
            <p>Which field do you work in?</p>
            <select name="industry" id="industry">
                <option value="">Select</option>
                <option value="None">None</option>
                <option value="Academia">Academia</option>
                <option value="Industry">Industry</option>
                <option value="Other">Other</option>
            </select>
        </div>

        <div class="questions">
            <p>Please specify the gender with which you most closely identify:</p>
            <select name="gender" id="gender">
                <option value=-1>Select</option>
                <option value=0>Woman</option>
                <option value=1>Man</option>
                <option value=2>Non-binary</option>
                <option value=3>Prefer not to answer</option>
            </select>
            <br />
        </div>

        <div class="questions">
            <p>What is your age?</p>
            <select name="age" id="age">
                <option value=-1>Select</option>
                <option value=0>18-22</option>
                <option value=1>23-30</option>
                <option value=2>31-40</option>
                <option value=3>41-50</option>
                <option value=4>51-60</option>
                <option value=5>Over 60</option>
                <option value=6>Prefer not to answer</option>
            </select>
        </div>

        <div class="questions">
            <p>What is the highest degree or level of school you have completed?</p>
            <select name="degree" id="degree">
                <option value=-1>Select</option>
                <option value=0>Some high school credit, no diploma or equivalent</option>
                <option value=1>Less than high school degree</option>
                <option value=2>High school graduate (high school diploma or equivalent including GED) </option>
                <option value=3>Some college but no degree</option>
                <option value=4>Associate's degree</option>
                <option value=5>Bachelor's degree</option>
                <option value=6>Advanced degree (e.g., Master's, doctorate)</option>
                <option value=7>Prefer not to answer</option>
            </select>
        </div>

        <br />
        <p>Please answer all questions before submitting.</p>
        <div style="text-align: center;">
            <button type=button id="submit">Submit</button>
        </div>
    </div>

    <script>
        function toggleFields(show) {
            document.getElementById('fp-languages').classList.toggle('hidden', !show);
            document.getElementById('fp-yoe').classList.toggle('hidden', !show);
        }

        document.getElementById('submit').addEventListener("click", () => {

            let yearsOfExp = document.getElementById("yearsOfExp").value;
            let rustExp = document.getElementById("rustExp").value;
            if (rustExp == -1) {
                document.getElementById("warn").innerHTML = "One or more questions are unanswered.";
                document.getElementById("rustExp").focus();
                return;
            }
            let linesOfCode = document.getElementById("linesOfCode").value;
            if (linesOfCode == -1) {
                document.getElementById("warn").innerHTML = "One or more questions are unanswered.";
                document.getElementById("linesOfCode").focus();
                return;
            }

            let fp = document.getElementById("fp-yes").checked;
            let fplanguages = document.getElementsByName("languages");
            let fpyoe = document.getElementById("fp-yoe").value;

            let java = document.querySelectorAll('input[name="java"]');
            let javaExp = '';
            for (const rb of java) {
                if (rb.checked) {
                    javaExp = rb.value;
                    break;
                }
            }
            if (javaExp == '') {
                document.getElementById("warn").innerHTML = "One or more questions are unanswered.";
                document.getElementById("java").focus();
                return;
            }

            let javascript = document.querySelectorAll('input[name="javascript"]');
            let jsExp = '';
            for (const rb of javascript) {
                if (rb.checked) {
                    jsExp = rb.value;
                    break;
                }
            }
            if (jsExp == '') {
                document.getElementById("warn").innerHTML = "One or more questions are unanswered.";
                document.getElementById("js").focus();
                return;
            }

            let clang = document.querySelectorAll('input[name="clang"]');
            let cExp = '';
            for (const rb of clang) {
                if (rb.checked) {
                    cExp = rb.value;
                    break;
                }
            }
            if (cExp == '') {
                document.getElementById("warn").innerHTML = "One or more questions are unanswered.";
                document.getElementById("c").focus();
                return;
            }

            let cpp = document.querySelectorAll('input[name="clang"]');
            let cppExp = '';
            for (const rb of cpp) {
                if (rb.checked) {
                    cppExp = rb.value;
                    break;
                }
            }
            if (cppExp == '') {
                document.getElementById("warn").innerHTML = "One or more questions are unanswered.";
                document.getElementById("cpp").focus();
                return;
            }

            let python = document.querySelectorAll('input[name="python"]');
            let pythonExp = '';
            for (const rb of python) {
                if (rb.checked) {
                    pythonExp = rb.value;
                    break;
                }
            }
            if (pythonExp == '') {
                document.getElementById("warn").innerHTML = "One or more questions are unanswered.";
                document.getElementById("python").focus();
                return;
            }

            let rustBook = document.getElementById("resources1").checked;
            let youtube = document.getElementById("resources2").checked;
            let stackOverflow = document.getElementById("resources3").checked;
            let other = document.getElementById("resources4").checked;

            let industry = document.getElementById("industry").value;
            if (industry == "") {
                document.getElementById("warn").innerHTML = "One or more questions are unanswered.";
                document.getElementById("industry").focus();
                return;
            }
            let gender = document.getElementById("gender").value;
            if (gender == -1) {
                document.getElementById("warn").innerHTML = "One or more questions are unanswered.";
                document.getElementById("gender").focus();
                return;
            }
            let age = document.getElementById("age").value;
            if (age == -1) {
                document.getElementById("warn").innerHTML = "One or more questions are unanswered.";
                document.getElementById("age").focus();
                return;
            }
            let degree = document.getElementById("degree").value;
            if (degree == -1) {
                document.getElementById("warn").innerHTML = "One or more questions are unanswered.";
                document.getElementById("degree").focus();
                return;
            }


            let results = {
                "experience": {
                    "codingExp": yearsOfExp,
                    "rustExp": rustExp,
                    "linesOfCode": linesOfCode,
                    "fp": fp,
                    "fpLanguages": fplanguages,
                    "fpYOE": fpyoe
                },
                "languages": {
                    "java": javaExp,
                    "javascript": jsExp,
                    "c": cExp,
                    "cpp": cppExp,
                    "python": pythonExp,
                },
                "resources": {
                    "rustBook": rustBook,
                    "youtube": youtube,
                    "stackOverflow": stackOverflow,
                    "other": other,
                },

                "demographics": {
                    "industry": industry,
                    "gender": gender,
                    "age": age,
                    "degree": degree
                }
            }
            console.log(results);

            //Send a message to the extension with the form data
            const vscode = acquireVsCodeApi();
            vscode.postMessage({
                command: 'submitSurvey',
                text: results
            });
        });
    </script>

</html>